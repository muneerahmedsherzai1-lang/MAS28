- name: Enable RDP (Strong Password)
  shell: pwsh
  run: |
    Write-Host "Enabling RDP..."

    # Generate strong random password
    $Password = -join (
      (48..57) + (65..90) + (97..122) + (33..38) |
      Get-Random -Count 16 | ForEach-Object {[char]$_}
    )

    net user runneradmin "$Password"

    Set-ItemProperty `
      -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server' `
      -Name "fDenyTSConnections" -Value 0

    Enable-NetFirewallRule -DisplayGroup "Remote Desktop"

    Write-Host "=============================="
    Write-Host "RDP LOGIN DETAILS"
    Write-Host "Username: runneradmin"
    Write-Host "Password: $Password"
    Write-Host "=============================="
